javascript:(function()%7Bfunction Cipher(input%2Cw)%7Bvar Nb%3D4%3Bvar Nr%3Dw.length%2FNb-1%3Bvar state%3D%5B%5B%5D%2C%5B%5D%2C%5B%5D%2C%5B%5D%5D%3Bfor(var i%3D0%3Bi<4*Nb%3Bi%2B%2B)state%5Bi%254%5D%5BMath.floor(i%2F4)%5D%3Dinput%5Bi%5D%3Bstate%3DAddRoundKey(state%2Cw%2C0%2CNb)%3Bfor(var round%3D1%3B round<Nr%3Bround%2B%2B)%7Bstate %3D SubBytes(state%2CNb)%3Bstate%3DShiftRows(state%2CNb)%3Bstate%3DMixColumns(state%2CNb)%3Bstate%3DAddRoundKey(state%2Cw%2Cround%2CNb)%3B%7Dstate%3DSubBytes(state%2C Nb)%3Bstate%3DShiftRows(state%2C Nb)%3Bstate%3DAddRoundKey(state%2Cw%2CNr%2CNb)%3Bvar output%3Dnew Array(4*Nb)%3Bfor(var i%3D0%3Bi<4*Nb%3Bi%2B%2B) output%5Bi%5D%3Dstate%5Bi%254%5D%5BMath.floor(i%2F4)%5D%3Breturn output%3B%7Dfunction SubBytes(s%2CNb) %7Bfor(var r%3D0%3Br<4%3Br%2B%2B)%7Bfor(var c%3D0%3Bc<Nb%3Bc%2B%2B) s%5Br%5D%5Bc%5D%3DSbox%5Bs%5Br%5D%5Bc%5D%5D%3B%7Dreturn s%3B%7Dfunction ShiftRows(s%2CNb)%7Bvar t%3Dnew Array(4)%3Bfor(var r%3D1%3Br<4%3Br%2B%2B)%7Bfor(var c%3D0%3Bc<4%3Bc%2B%2B) t%5Bc%5D%3Ds%5Br%5D%5B(c%2Br)%25Nb%5D%3Bfor(var c%3D0%3Bc<4%3Bc%2B%2B) s%5Br%5D%5Bc%5D%3Dt%5Bc%5D%3B%7Dreturn s%3B%7Dfunction MixColumns(s%2CNb)%7Bfor (var c%3D0%3Bc<4%3Bc%2B%2B)%7Bvar a%3Dnew Array(4)%3Bvar b%3Dnew Array(4)%3Bfor(var i%3D0%3Bi<4%3Bi%2B%2B)%7Ba%5Bi%5D%3Ds%5Bi%5D%5Bc%5D%3Bb%5Bi%5D%3Ds%5Bi%5D%5Bc%5D%260x80 %3F s%5Bi%5D%5Bc%5D<<1%5E0x011b %3A s%5Bi%5D%5Bc%5D<<1%3B%7Ds%5B0%5D%5Bc%5D%3Db%5B0%5D%5Ea%5B1%5D%5Eb%5B1%5D%5Ea%5B2%5D%5Ea%5B3%5D%3Bs%5B1%5D%5Bc%5D%3Da%5B0%5D%5Eb%5B1%5D%5Ea%5B2%5D%5Eb%5B2%5D%5Ea%5B3%5D%3Bs%5B2%5D%5Bc%5D%3Da%5B0%5D%5Ea%5B1%5D%5Eb%5B2%5D%5Ea%5B3%5D%5Eb%5B3%5D%3Bs%5B3%5D%5Bc%5D%3Da%5B0%5D%5Eb%5B0%5D%5Ea%5B1%5D%5Ea%5B2%5D%5Eb%5B3%5D%3B%7Dreturn s%3B%7Dfunction AddRoundKey(state%2Cw%2Crnd%2CNb)%7Bfor(var r%3D0%3Br<4%3Br%2B%2B)%7Bfor(var c%3D0%3Bc<Nb%3Bc%2B%2B)state%5Br%5D%5Bc%5D%5E%3Dw%5Brnd*4%2Bc%5D%5Br%5D%3B%7Dreturn state%3B%7Dfunction KeyExpansion(key)%7Bvar Nb%3D4%3Bvar Nk%3D key.length%2F4%3Bvar Nr%3DNk%2B6%3Bvar w%3Dnew Array(Nb*(Nr%2B1))%3Bvar temp%3Dnew Array(4)%3Bfor(var i%3D0%3Bi<Nk%3Bi%2B%2B)%7Bvar r%3D%5Bkey%5B4*i%5D%2Ckey%5B4*i%2B1%5D%2Ckey%5B4*i%2B2%5D%2Ckey%5B4*i%2B3%5D%5D%3Bw%5Bi%5D%3Dr%3B%7Dfor(var i%3DNk%3Bi<(Nb*(Nr%2B1))%3Bi%2B%2B)%7Bw%5Bi%5D%3Dnew Array(4)%3Bfor(var t%3D0%3Bt<4%3Bt%2B%2B)temp%5Bt%5D%3Dw%5Bi-1%5D%5Bt%5D%3Bif(i%25Nk%3D%3D0)%7Btemp%3DSubWord(RotWord(temp))%3Bfor(var t%3D0%3Bt<4%3Bt%2B%2B)temp%5Bt%5D%5E%3DRcon%5Bi%2FNk%5D%5Bt%5D%3B%7Delse if(Nk>6%26%26i%25Nk%3D%3D4)%7Btemp%3DSubWord(temp)%3B%7Dfor(var t%3D0%3Bt<4%3Bt%2B%2B)w%5Bi%5D%5Bt%5D%3Dw%5Bi-Nk%5D%5Bt%5D%5Etemp%5Bt%5D%3B%7Dreturn w%3B%7Dfunction SubWord(w)%7Bfor(var i%3D0%3Bi<4%3Bi%2B%2B)w%5Bi%5D%3DSbox%5Bw%5Bi%5D%5D%3Breturn w%3B%7Dfunction RotWord(w)%7Bvar tmp%3Dw%5B0%5D%3Bfor(var i%3D0%3Bi<3%3Bi%2B%2B)w%5Bi%5D%3Dw%5Bi%2B1%5D%3Bw%5B3%5D%3Dtmp%3Breturn w%3B%7Dvar Sbox%3D%5B0x63%2C0x7c%2C0x77%2C0x7b%2C0xf2%2C0x6b%2C0x6f%2C0xc5%2C0x30%2C0x01%2C0x67%2C0x2b%2C0xfe%2C0xd7%2C0xab%2C0x76%2C0xca%2C0x82%2C0xc9%2C0x7d%2C0xfa%2C0x59%2C0x47%2C0xf0%2C0xad%2C0xd4%2C0xa2%2C0xaf%2C0x9c%2C0xa4%2C0x72%2C0xc0%2C0xb7%2C0xfd%2C0x93%2C0x26%2C0x36%2C0x3f%2C0xf7%2C0xcc%2C0x34%2C0xa5%2C0xe5%2C0xf1%2C0x71%2C0xd8%2C0x31%2C0x15%2C0x04%2C0xc7%2C0x23%2C0xc3%2C0x18%2C0x96%2C0x05%2C0x9a%2C0x07%2C0x12%2C0x80%2C0xe2%2C0xeb%2C0x27%2C0xb2%2C0x75%2C0x09%2C0x83%2C0x2c%2C0x1a%2C0x1b%2C0x6e%2C0x5a%2C0xa0%2C0x52%2C0x3b%2C0xd6%2C0xb3%2C0x29%2C0xe3%2C0x2f%2C0x84%2C0x53%2C0xd1%2C0x00%2C0xed%2C0x20%2C0xfc%2C0xb1%2C0x5b%2C0x6a%2C0xcb%2C0xbe%2C0x39%2C0x4a%2C0x4c%2C0x58%2C0xcf%2C0xd0%2C0xef%2C0xaa%2C0xfb%2C0x43%2C0x4d%2C0x33%2C0x85%2C0x45%2C0xf9%2C0x02%2C0x7f%2C0x50%2C0x3c%2C0x9f%2C0xa8%2C0x51%2C0xa3%2C0x40%2C0x8f%2C0x92%2C0x9d%2C0x38%2C0xf5%2C0xbc%2C0xb6%2C0xda%2C0x21%2C0x10%2C0xff%2C0xf3%2C0xd2%2C0xcd%2C0x0c%2C0x13%2C0xec%2C0x5f%2C0x97%2C0x44%2C0x17%2C0xc4%2C0xa7%2C0x7e%2C0x3d%2C0x64%2C0x5d%2C0x19%2C0x73%2C0x60%2C0x81%2C0x4f%2C0xdc%2C0x22%2C0x2a%2C0x90%2C0x88%2C0x46%2C0xee%2C0xb8%2C0x14%2C0xde%2C0x5e%2C0x0b%2C0xdb%2C0xe0%2C0x32%2C0x3a%2C0x0a%2C0x49%2C0x06%2C0x24%2C0x5c%2C0xc2%2C0xd3%2C0xac%2C0x62%2C0x91%2C0x95%2C0xe4%2C0x79%2C0xe7%2C0xc8%2C0x37%2C0x6d%2C0x8d%2C0xd5%2C0x4e%2C0xa9%2C0x6c%2C0x56%2C0xf4%2C0xea%2C0x65%2C0x7a%2C0xae%2C0x08%2C0xba%2C0x78%2C0x25%2C0x2e%2C0x1c%2C0xa6%2C0xb4%2C0xc6%2C0xe8%2C0xdd%2C0x74%2C0x1f%2C0x4b%2C0xbd%2C0x8b%2C0x8a%2C0x70%2C0x3e%2C0xb5%2C0x66%2C0x48%2C0x03%2C0xf6%2C0x0e%2C0x61%2C0x35%2C0x57%2C0xb9%2C0x86%2C0xc1%2C0x1d%2C0x9e%2C0xe1%2C0xf8%2C0x98%2C0x11%2C0x69%2C0xd9%2C0x8e%2C0x94%2C0x9b%2C0x1e%2C0x87%2C0xe9%2C0xce%2C0x55%2C0x28%2C0xdf%2C0x8c%2C0xa1%2C0x89%2C0x0d%2C0xbf%2C0xe6%2C0x42%2C0x68%2C0x41%2C0x99%2C0x2d%2C0x0f%2C0xb0%2C0x54%2C0xbb%2C0x16%5D%3Bvar Rcon%3D%5B%5B0x00%2C0x00%2C0x00%2C0x00%5D%2C%5B0x01%2C0x00%2C0x00%2C0x00%5D%2C%5B0x02%2C0x00%2C0x00%2C0x00%5D%2C%5B0x04%2C0x00%2C0x00%2C0x00%5D%2C%5B0x08%2C0x00%2C0x00%2C0x00%5D%2C%5B0x10%2C0x00%2C0x00%2C0x00%5D%2C%5B0x20%2C0x00%2C0x00%2C0x00%5D%2C%5B0x40%2C0x00%2C0x00%2C0x00%5D%2C%5B0x80%2C0x00%2C0x00%2C0x00%5D%2C%5B0x1b%2C0x00%2C0x00%2C0x00%5D%2C%5B0x36%2C0x00%2C0x00%2C0x00%5D%5D%3Bfunction AESEncryptCtr(plaintext%2Cpassword%2CnBits)%7Bvar blockSize%3D16%3Bif(!(nBits%3D%3D128%7C%7CnBits%3D%3D192%7C%7CnBits%3D%3D256))return ''%3Bplaintext%3Dplaintext.encodeUTF8()%3Bpassword%3Dpassword.encodeUTF8()%3Bvar nBytes%3DnBits%2F8%3Bvar pwBytes%3Dnew Array(nBytes)%3Bfor(var i%3D0%3Bi<nBytes%3Bi%2B%2B)%7BpwBytes%5Bi%5D%3DisNaN(password.charCodeAt(i))%3F0%3Apassword.charCodeAt(i)%3B%7Dvar key%3DCipher(pwBytes%2CKeyExpansion(pwBytes))%3Bkey%3Dkey.concat(key.slice(0%2CnBytes-16))%3Bvar counterBlock%3Dnew Array(blockSize)%3Bvar nonce%3D(new Date()).getTime()%3Bvar nonceSec%3DMath.floor(nonce%2F1000)%3Bvar nonceMs%3Dnonce%251000%3Bfor(var i%3D0%3Bi<4%3Bi%2B%2B)counterBlock%5Bi%5D%3D(nonceSec>>>i*8)%260xff%3Bfor(var i%3D0%3Bi<4%3Bi%2B%2B)counterBlock%5Bi%2B4%5D%3DnonceMs%260xff%3Bvar ctrTxt%3D''%3Bfor(var i%3D0%3Bi<8%3Bi%2B%2B)ctrTxt%2B%3DString.fromCharCode(counterBlock%5Bi%5D)%3Bvar keySchedule%3DKeyExpansion(key)%3Bvar blockCount%3DMath.ceil(plaintext.length%2FblockSize)%3Bvar ciphertxt%3Dnew Array(blockCount)%3Bfor (var b%3D0%3Bb<blockCount%3Bb%2B%2B)%7Bfor(var c%3D0%3Bc<4%3Bc%2B%2B)counterBlock%5B15-c%5D%3D(b>>>c*8)%260xff%3Bfor(var c%3D0%3Bc<4%3Bc%2B%2B)counterBlock%5B15-c-4%5D%3D(b%2F0x100000000>>>c*8)%3Bvar cipherCntr%3DCipher(counterBlock%2CkeySchedule)%3Bvar blockLength%3Db<blockCount-1%3FblockSize%3A(plaintext.length-1)%25blockSize%2B1%3Bvar cipherChar%3Dnew Array(blockLength)%3Bfor(var i%3D0%3Bi<blockLength%3Bi%2B%2B)%7BcipherChar%5Bi%5D%3DcipherCntr%5Bi%5D%5Eplaintext.charCodeAt(b*blockSize%2Bi)%3BcipherChar%5Bi%5D%3DString.fromCharCode(cipherChar%5Bi%5D)%3B%7Dciphertxt%5Bb%5D %3D cipherChar.join('')%3B%7Dvar ciphertext%3DctrTxt%2Bciphertxt.join('')%3Bciphertext%3Dciphertext.encodeBase64()%3Breturn ciphertext%3B%7Dfunction AESDecryptCtr(ciphertext%2Cpassword%2CnBits)%7Bvar blockSize%3D16%3Bif(!(nBits%3D%3D128%7C%7CnBits%3D%3D192%7C%7CnBits%3D%3D256))return ''%3Bciphertext%3Dciphertext.decodeBase64()%3Bpassword%3Dpassword.encodeUTF8()%3Bvar nBytes%3DnBits%2F8%3Bvar pwBytes%3Dnew Array(nBytes)%3Bfor(var i%3D0%3Bi<nBytes%3Bi%2B%2B)%7BpwBytes%5Bi%5D%3DisNaN(password.charCodeAt(i))%3F0%3Apassword.charCodeAt(i)%3B%7Dvar key%3DCipher(pwBytes%2CKeyExpansion(pwBytes))%3Bkey%3Dkey.concat(key.slice(0%2CnBytes-16))%3Bvar counterBlock%3Dnew Array(8)%3BctrTxt%3Dciphertext.slice(0%2C 8)%3Bfor(var i%3D0%3Bi<8%3Bi%2B%2B)counterBlock%5Bi%5D%3DctrTxt.charCodeAt(i)%3Bvar keySchedule%3DKeyExpansion(key)%3Bvar nBlocks%3DMath.ceil((ciphertext.length-8)%2FblockSize)%3Bvar ct%3Dnew Array(nBlocks)%3Bfor(var b%3D0%3Bb<nBlocks%3Bb%2B%2B)ct%5Bb%5D%3Dciphertext.slice(8%2Bb*blockSize%2C8%2Bb*blockSize%2BblockSize)%3Bciphertext%3Dct%3Bvar plaintxt%3Dnew Array(ciphertext.length)%3Bfor(var b%3D0%3Bb<nBlocks%3Bb%2B%2B)%7Bfor(var c%3D0%3Bc<4%3Bc%2B%2B)counterBlock%5B15-c%5D%3D((b)>>>c*8)%260xff%3Bfor(var c%3D0%3Bc<4%3Bc%2B%2B)counterBlock%5B15-c-4%5D%3D(((b%2B1)%2F0x100000000-1)>>>c*8)%260xff%3Bvar cipherCntr%3DCipher(counterBlock%2C keySchedule)%3Bvar plaintxtByte%3Dnew Array(ciphertext%5Bb%5D.length)%3Bfor(var i%3D0%3Bi<ciphertext%5Bb%5D.length%3Bi%2B%2B)%7BplaintxtByte%5Bi%5D%3DcipherCntr%5Bi%5D %5E ciphertext%5Bb%5D.charCodeAt(i)%3BplaintxtByte%5Bi%5D%3DString.fromCharCode(plaintxtByte%5Bi%5D)%3B%7Dplaintxt%5Bb%5D%3DplaintxtByte.join('')%3B%7Dvar plaintext%3Dplaintxt.join('')%3Bplaintext%3Dplaintext.decodeUTF8()%3Breturn plaintext%3B%7Dvar b64%3D'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%2B%2F%3D'%3BString.prototype.encodeBase64%3Dfunction(utf8encode)%7Butf8encode%3D(typeof utf8encode%3D%3D'undefined')%3Ffalse%3Autf8encode%3Bvar o1%2Co2%2Co3%2Cbits%2Ch1%2Ch2%2Ch3%2Ch4%2Ce%3D%5B%5D%2Cpad%3D''%2Cc%2Cplain%2Ccoded%3Bplain%3Dutf8encode%3Fthis.encodeUTF8()%3Athis%3Bc%3Dplain.length%253%3Bif(c>0)%7Bwhile(c%2B%2B<3)%7Bpad%2B%3D'%3D'%3Bplain%2B%3D'%5C0'%3B%7D%7Dfor(c%3D0%3Bc<plain.length%3Bc%2B%3D3)%7Bo1%3Dplain.charCodeAt(c)%3Bo2%3Dplain.charCodeAt(c%2B1)%3Bo3%3Dplain.charCodeAt(c%2B2)%3Bbits%3Do1<<16%7Co2<<8%7Co3%3Bh1%3Dbits>>18%260x3f%3Bh2%3Dbits>>12%260x3f%3Bh3%3Dbits>>6%260x3f%3Bh4%3Dbits%260x3f%3Be%5Bc%2F3%5D%3Db64.charAt(h1)%2Bb64.charAt(h2)%2Bb64.charAt(h3)%2Bb64.charAt(h4)%3B%7Dcoded%3De.join('')%3Bcoded%3Dcoded.slice(0%2Ccoded.length-pad.length)%2Bpad%3Breturn coded%3B%7D%3BString.prototype.decodeBase64%3Dfunction(utf8decode)%7Butf8decode%3D(typeof utf8decode%3D%3D'undefined')%3Ffalse%3Autf8decode%3Bvar o1%2Co2%2Co3%2Ch1%2Ch2%2Ch3%2Ch4%2Cbits%2Cd%3D%5B%5D%2Cplain%2Ccoded%3Bcoded%3Dutf8decode%3Fthis.decodeUTF8()%3Athis%3Bfor(var c%3D0%3Bc<coded.length%3Bc%2B%3D4)%7Bh1%3Db64.indexOf(coded.charAt(c))%3Bh2%3Db64.indexOf(coded.charAt(c%2B1))%3Bh3%3Db64.indexOf(coded.charAt(c%2B2))%3Bh4%3Db64.indexOf(coded.charAt(c%2B3))%3Bbits%3Dh1<<18%7Ch2<<12%7Ch3<<6%7Ch4%3Bo1%3Dbits>>>16%260xff%3Bo2%3Dbits>>>8%260xff%3Bo3%3Dbits%260xff%3Bd%5Bc%2F4%5D%3DString.fromCharCode(o1%2Co2%2Co3)%3Bif(h4%3D%3D0x40)d%5Bc%2F4%5D%3DString.fromCharCode(o1%2Co2)%3Bif(h3%3D%3D0x40)d%5Bc%2F4%5D%3DString.fromCharCode(o1)%3B%7Dplain%3Dd.join('')%3Breturn utf8decode%3Fplain.decodeUTF8()%3Aplain%3B%7D%3BString.prototype.encodeUTF8%3Dfunction()%7Bvar str%3Dthis.replace(%2F%5B%5Cu0080-%5Cu07ff%5D%2Fg%2Cfunction(c)%7Bvar cc%3Dc.charCodeAt(0)%3Breturn String.fromCharCode(0xc0%7Ccc>>6%2C0x80%7Ccc%260x3f)%3B%7D)%3Bstr%3Dstr.replace(%2F%5B%5Cu0800-%5Cuffff%5D%2Fg%2Cfunction(c)%7Bvar cc%3Dc.charCodeAt(0)%3Breturn String.fromCharCode(0xe0%7Ccc>>12%2C0x80%7Ccc>>6%260x3F%2C0x80%7Ccc%260x3f)%3B%7D)%3Breturn str%3B%7D%3BString.prototype.decodeUTF8%3Dfunction()%7Bvar str%3Dthis.replace(%2F%5B%5Cu00c0-%5Cu00df%5D%5B%5Cu0080-%5Cu00bf%5D%2Fg%2Cfunction(c)%7Bvar cc%3D(c.charCodeAt(0)%260x1f)<<6%7Cc.charCodeAt(1)%260x3f%3Breturn String.fromCharCode(cc)%3B%7D)%3Bstr%3Dstr.replace(%2F%5B%5Cu00e0-%5Cu00ef%5D%5B%5Cu0080-%5Cu00bf%5D%5B%5Cu0080-%5Cu00bf%5D%2Fg%2Cfunction(c) %7Bvar cc%3D((c.charCodeAt(0)%260x0f)<<12)%7C((c.charCodeAt(1)%260x3f)<<6)%7C(c.charCodeAt(2)%260x3f)%3Breturn String.fromCharCode(cc)%3B%7D)%3Breturn str%3B%7D%3Bvar text%3Dwindow.getSelection%3Fwindow.getSelection().toString()%3Adocument.selection.createRange().text%3Bif(!text)%7Btext%3Dwindow.prompt('%5Ct%5BAES 256 Bookmarklet%5D (*.^)%5Ct%5Cn%5Ct2013 by guelfoweb%5Ct%5Cn%5Cn%5CtInsert your text here and press Ok%5Ct%5Ct'%2C'')%3B%7Dif(!text)%7Breturn%3B%7Dvar pass%3Dprompt('%5Ct%5BAES Shortcut%5D%5Cn%5CtInsert Passphrase here ******%5Ct%5Ct'%2C'')%3Bif(pass)%7Bvar tag%3D%2F\[aesbookmarklet\](.*)\[%5C%2Faesbookmarklet\]%2F%3Bif(tag.test(text))%7Bvar matches%3Dtag.exec(text)%3Btext%3Dmatches%5B1%5D%3Bdec%3DAESDecryptCtr(text%2Cpass%2C256)%3Bwindow.prompt('%5Ct%5BDecrypted text%5D%5Cn%5CtCopy selected text. Enjoy!%5Ct%5Ct'%2Cdec)%3B%7Delse%7Benc%3DAESEncryptCtr(text%2Cpass%2C256)%3Bwindow.prompt('%5Ct%5BEncrypted text%5D%5Cn%5CtCopy selected text ;-\)%5Ct%5Ct'%2C'\[aesbookmarklet\]'%2Benc%2B'\[%2Faesbookmarklet\]')%3B%7D%7D%7D)()
